{"version":3,"sources":["App.js","serviceWorker.js","index.js"],"names":["formatDate","date","Intl","DateTimeFormat","format","Date","App","useState","showLoginForm","setShowLoginForm","JSON","parse","localStorage","getItem","loginData","setLoginData","modalData","setModalData","formData","setFormData","userData","setUserData","useEffect","loadUserData","auth","a","console","log","axios","res","errors","data","localStorageObject","clentName","lname","fname","clentId","id","setItem","stringify","url","window","location","href","split","length","substring","handleClose","className","Modal","show","onHide","size","enforceFocus","autoFocus","aria-labelledby","centered","onEscapeKeyDown","animation","Header","closeButton","Title","title","Body","text","Footer","Button","variant","onClick","style","paddingTop","Row","map","user","Card","width","Text","payments","debt","subscriptions","sub","plan","label","months","toString","from","to","nextCharge","extraDays","fontSize","nextUrl","replace","src","alt","type","name","onChange","event","target","value","email","placeholder","error","Boolean","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.808f9183.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\n//import moment from \"moment-timezone\";\nimport { Button, Modal, Row, Card } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport \"./App.css\";\n\nconst localStorageKey = \"formDataInLocalStorage\";\n\nfunction formatDate(date) {\n  return Intl.DateTimeFormat(\"gr-el\").format(new Date(date));\n}\n\nfunction App() {\n  const [showLoginForm, setShowLoginForm] = useState(false);\n  const [loginData, setLoginData] = useState(\n    JSON.parse(localStorage.getItem(localStorageKey))\n  );\n\n  const [modalData, setModalData] = useState(null);\n\n  const [formData, setFormData] = useState(null);\n  const [userData, setUserData] = useState(null);\n\n  useEffect(() => {\n    async function loadUserData(auth) {\n      try {\n        console.log(\"Loaging Data...\");\n        const res = await axios(\n          `https://spgapps.tk/exec/userData/auth=${auth}`\n        );\n        if (!res.errors) {\n          res.data.data.auth = auth;\n\n          let localStorageObject = {};\n          localStorageObject.auth = res.data.data.auth;\n          localStorageObject.clentName =\n            res.data.data[0].lname + \" \" + res.data.data[0]?.fname;\n          localStorageObject.clentId = res.data.data[0].id;\n\n          localStorage.setItem(\n            localStorageKey,\n            JSON.stringify(localStorageObject)\n          );\n          setLoginData(localStorageObject);\n          setUserData(res.data.data);\n        } else {\n        }\n      } catch (error) {}\n    }\n\n    if (!loginData) {\n      const url = window.location.href.split(\"/\");\n      var auth;\n\n      if (\n        url.length > 2 &&\n        url[url.length - 2] === \"app\" &&\n        url[url.length - 1] !== \"\"\n      ) {\n        auth = url[url.length - 1].substring(1);\n      } else {\n        setShowLoginForm(true);\n      }\n      if (auth && !userData) loadUserData(auth);\n    } else {\n      if (loginData.auth && !userData) loadUserData(loginData.auth);\n    }\n  }, [loginData, userData]);\n\n  const handleClose = () => setModalData(null);\n\n  function handleChange(event) {\n    console.log(event.target.name, event.target.value);\n    setFormData({ ...formData, email: event.target.value });\n  }\n\n  return (\n    <div className=\"container h-100\">\n      {modalData && (\n        <Modal\n          show={modalData}\n          onHide={handleClose}\n          size=\"md\"\n          enforceFocus={false}\n          autoFocus\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n          onEscapeKeyDown={handleClose}\n          animation={false}\n        >\n          <Modal.Header closeButton>\n            <Modal.Title id=\"contained-modal-title-vcenter\">\n              {modalData.title}\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>{modalData.text}</Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"secondary\" onClick={handleClose}>\n              Close\n            </Button>\n          </Modal.Footer>\n        </Modal>\n      )}\n\n      {loginData && loginData.auth && (\n        <div>\n          <div className=\"d-flex justify-content-center  \">\n            <div style={{ paddingTop: \"30px\" }}>\n              <Row>\n                {userData &&\n                  userData.map((user) => (\n                    <div>\n                      <Card style={{ width: \"600\" }}>\n                        <Card.Header>\n                          {user.lname} {user.fname}\n                        </Card.Header>\n                        <Card.Body>\n                          <Card.Text>\n                            Τελευταία Πλήρωμη:{\" \"}\n                            {formatDate(user.payments[0].date)}\n                            <br /> <br />\n                            {user.debt && user.debt > 0 && (\n                              <>\n                                <b>Υπάρχουν οικονομικές εκκρεμότητες!</b>\n                                <br />\n                                Παρακαλώ επικοινωνήστε με το προσωπικό του\n                                γυμναστήριου.\n                              </>\n                            )}\n                            <br />\n                            <br />\n                            Συνδρομές:\n                            {user.subscriptions &&\n                              user.subscriptions.map((sub) => (\n                                <div style={{ paddingTop: \"1rem\" }}>\n                                  <Card style={{ width: \"18rem\" }}>\n                                    <Card.Header>\n                                      {sub.plan.label +\n                                        \"  (\" +\n                                        (sub.plan.months === 1\n                                          ? \"Mηνιαία)\"\n                                          : sub.plan.months.toString() +\n                                            \" μήνες)\")}\n                                    </Card.Header>\n                                    <Card.Body>\n                                      <Card.Text>\n                                        Έναρξη: {formatDate(sub.from)}\n                                        <br />\n                                        {sub.to && (\n                                          <>\n                                            Λήξη: {formatDate(sub.to)}\n                                            <br />\n                                          </>\n                                        )}\n                                        {!sub.to && (\n                                          <>\n                                            Ανανέωση:{\" \"}\n                                            {formatDate(sub.nextCharge)}\n                                            <br />\n                                          </>\n                                        )}\n                                        {/* {!sub.to && (\n                          <>\n                            Ανανέωση: {formatDate(nextCharge(sub))}\n                            <br />\n                          </>\n                        )} */}\n                                      </Card.Text>\n                                    </Card.Body>\n                                    {sub.extraDays && sub.extraDays > 0 && (\n                                      <Card.Footer>\n                                        <small className=\"text-muted\">\n                                          Στην συνδρομή έχουν προστεθεί{\" \"}\n                                          {sub.extraDays} ημέρες χωρίς χρέωση!\n                                        </small>\n                                      </Card.Footer>\n                                    )}\n                                  </Card>\n                                </div>\n                              ))}\n                          </Card.Text>\n                        </Card.Body>\n                        <Card.Footer style={{ fontSize: \"0.7em\" }}>\n                          <a\n                            //className=\"btn-sm btn-primary\"\n                            href=\"./\"\n                            onClick={() => {\n                              let nextUrl = window.location.href.replace(\n                                \"/?\" + loginData.auth,\n                                \"\"\n                              );\n                              if (window.location.href !== nextUrl)\n                                window.location = nextUrl;\n                              setLoginData(null);\n                              setUserData(null);\n\n                              localStorage.setItem(localStorageKey, null);\n                            }}\n                          >\n                            Δεν θέλω να με θυμαται ο browser.\n                          </a>\n                          &nbsp;Για να μπορέσω να δω και πάλι τα στοιχεία την\n                          συνδρομής μου θα να ακολουθήσω τον σύνδεσμό που μου\n                          έχει σταλεί στο email μου ή να αιτηθώ νέο.\n                        </Card.Footer>\n                      </Card>\n                    </div>\n                  ))}\n              </Row>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showLoginForm && (\n        <div className=\"d-flex justify-content-center h-100\">\n          <div className=\"user_card\">\n            <div className=\"d-flex justify-content-center\">\n              <div className=\"brand_logo_container\">\n                <img\n                  src=\"./images/logo.png\"\n                  className=\"brand_logo\"\n                  alt=\"Logo\"\n                />\n              </div>\n            </div>\n\n            <div className=\"d-flex justify-content-center  form_container\">\n              <form>\n                <div className=\"input-group mb-4\">\n                  <center>\n                    Συμπλήρωσε το e-mail σου για να <br />\n                    σου στείλουμε τις οδηγίες σύνδεσης\n                  </center>\n                </div>\n                <div className=\"input-group mb-3\">\n                  <div className=\"input-group-append\">\n                    <span className=\"input-group-text\">\n                      <i className=\"fas fa-envelope\"></i>\n                    </span>\n                  </div>\n                  <input\n                    type=\"text\"\n                    name=\"email\"\n                    className=\"form-control input_email\"\n                    onChange={handleChange}\n                    value={formData ? formData.email : \"\"}\n                    placeholder=\"email\"\n                  />\n                </div>\n\n                <div className=\"d-flex justify-content-center mt-3 login_container\">\n                  <Button\n                    type=\"button\"\n                    name=\"button\"\n                    variant=\"primary\"\n                    className=\"btn login_btn\"\n                    onClick={async () => {\n                      if (formData) {\n                        let res = await axios(\n                          `https://spgapps.tk/x/b569b1afd005e5e1c843a89139d46d0527d44bd49f44a1d5242b791bd27d4faa/email=${formData.email}`\n                        );\n                        var data = res.data;\n\n                        if (data.errors) {\n                          setModalData({ title: \"Πρόβλημα\", text: data.error });\n                        } else {\n                          data = data.data;\n                          setModalData(data);\n                        }\n                      }\n                    }}\n                  >\n                    Αποστολή\n                  </Button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// function nextCharge(sub) {\n//   moment.tz.setDefault(\"Europe/Athens\");\n\n//   let plan = sub.plan;\n//   let from = moment(new Date(sub.from));\n\n//   from = from.add(sub.extraDays == null ? 0 : sub.extraDays, \"days\");\n\n//   if (sub.to != null && moment(sub.to).isBefore(Date.now())) {\n//     return null;\n//   } else {\n//     let to = moment(Date.now());\n\n//     let months =\n//       to.year() * 12 + to.month() - (from.year() * 12 + from.month());\n\n//     console.log(\"months\", months, to.month() + 1, from.month() + 1);\n\n//     if (to.date() >= from.date()) months++;\n\n//     let payPeriods = Math.floor(months / plan.months);\n\n//     if (payPeriods * plan.months < months) payPeriods++;\n\n//     return new Date(\n//       from.year(),\n//       from.month() + payPeriods * plan.months,\n//       from.date()\n//     );\n//   }\n// }\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}